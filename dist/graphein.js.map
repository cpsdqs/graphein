{"version":3,"sources":["webpack:///webpack/bootstrap 049db34bd78cb44042fa","webpack:///./src/layer.js","webpack:///./src/image.js","webpack:///./src/transform.js","webpack:///./src/index.js","webpack:///./src/canvas.js","webpack:///./src/path.js","webpack:///./src/color.js"],"names":["Transform","require","module","exports","Layer","constructor","type","types","GROUP","transform","children","serialize","map","child","render","ctx","save","forEach","restore","PATH","CLIPPING_MASK","RECTANGLE","CIRCLE","TEXT","RASTER_IMAGE","Image","version","width","height","w","h","c","beginPath","rect","clip","NONE","data","Float32Array","MAT3","MAT4","console","warn","deserialize","length","slice","Canvas","Path","graphein","window","HTMLElement","canvas","document","createElement","getContext","_image","connectedCallback","_didInit","appendChild","image","v","customElements","define","Color","basePath","createElementNS","widthL","widthR","StrokeRenderer","path","cursor","cursorL","cursorR","add","args","startsWith","substr","push","leftArgs","concat","rightArgs","getPath","item","join","getWidthL","getWidthR","setAttribute","baseLength","getTotalLength","resolution","devicePixelRatio","currentL","currentR","findNextPointAtX","target","start","x","Infinity","getPointAtLength","lastLeftPos","lastRightPos","point","leftPos","rightPos","left","y","right","moveTo","stroke","lineWidth","lineTo","instructionFunctions","Instruction","renderer","CLOSE_PATH","MOVE","MOVE_R","LINE","LINE_R","CUBIC_BEZIER","CUBIC_BEZIER_R","CUBIC_BEZIER_SHORT","CUBIC_BEZIER_SHORT_R","QUAD_BEZIER","QUAD_BEZIER_R","QUAD_BEZIER_SHORT","QUAD_BEZIER_SHORT_R","ARC","ARC_R","STROKE_WIDTH","STROKE_WIDTH_R","STROKE_WIDTH_BEZIER","STROKE_WIDTH_BEZIER_R","fill","cap","BUTT","BEVEL","miter","instruction","alpha","fillStyle","toCSS","Path2D","strokeStyle","ROUND","PROJECTING","MITER","red","green","blue"],"mappings":"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","file":"graphein.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 3);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 049db34bd78cb44042fa","const Transform = require('./transform')\n\nmodule.exports = class Layer {\n  constructor () {\n    this.type = Layer.types.GROUP\n    this.transform = new Transform()\n    this.children = []\n  }\n\n  serialize () {\n    return {\n      type: this.type,\n      transform: this.transform.serialize(),\n      children: this.children.map(child => child.serialize())\n    }\n  }\n\n  render (ctx) {\n    ctx.save()\n    this.transform.render(ctx)\n    this.children.forEach(child => child.render(ctx))\n    ctx.restore()\n  }\n\n  static types = {\n    GROUP: 'g',\n    PATH: 'p',\n    CLIPPING_MASK: 'c',\n    RECTANGLE: 'sr',\n    CIRCLE: 'sc',\n    TEXT: 't',\n    RASTER_IMAGE: 'b'\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/layer.js","const Layer = require('./layer')\n\nmodule.exports = class Image extends Layer {\n  constructor () {\n    super()\n\n    // TODO: don't hardcode\n    this.version = 0\n    this.width = 100\n    this.height = 100\n  }\n\n  serialize () {\n    return {\n      version: this.version,\n      w: this.width,\n      h: this.height,\n      c: this.children.map(child => child.serialize())\n    }\n  }\n\n  render (ctx) {\n    ctx.save()\n    ctx.beginPath()\n    ctx.rect(0, 0, this.width, this.height)\n    ctx.clip()\n    this.children.forEach(child => child.render(ctx))\n    ctx.restore()\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/image.js","module.exports = class Transform {\n  constructor () {\n    this.type = Transform.types.NONE\n    this.data = new Float32Array([])\n  }\n\n  serialize () {\n    return this.data\n  }\n\n  render (ctx) {\n    if (this.type === Transform.types.MAT3) {\n      ctx.transform(this.data[0], this.data[1], this.data[3], this.data[4], this.data[6], this.data[7])\n    } else if (this.type == Transform.types.MAT4) {\n      console.warn('Cannot properly render Mat4 on canvas')\n      ctx.transform(this.data[0], this.data[1], this.data[4], this.data[5], this.data[12], this.data[13])\n    }\n  }\n\n  static deserialize (data) {\n    let transform = new Transform()\n    transform.type = data.length === 16\n      ? Transform.types.MAT4\n      : data.length === 9\n      ? Transform.types.MAT3\n      : Transform.types.NONE\n    transform.data = new Float32Array(data.slice())\n    return transform\n  }\n\n  static types = {\n    NONE: 0,\n    MAT3: 1,\n    MAT4: 2\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/transform.js","const Canvas = require('./canvas')\nconst Image = require('./image')\nconst Layer = require('./layer')\nconst Transform = require('./transform')\nconst Path = require('./path')\n\nconst graphein = {\n  Canvas,\n  Image,\n  Layer,\n  Transform,\n  Path\n}\n\nmodule.exports = window.graphein = graphein\n\n\n\n// WEBPACK FOOTER //\n// ./src/index.js","const Image = require('./image')\n\nclass Canvas extends window.HTMLElement {\n  constructor () {\n    super()\n\n    this.canvas = document.createElement('canvas')\n    this.ctx = this.canvas.getContext('2d')\n\n    this._image = new Image()\n  }\n\n  connectedCallback () {\n    if (!this._didInit) {\n      this._didInit = true\n      this.appendChild(this.canvas)\n    }\n  }\n\n  get image () {\n    return this._image\n  }\n\n  set image (v) {\n    this._image = v\n    this.render()\n  }\n\n  render () {\n    this.image.render(this.ctx)\n  }\n}\n\nwindow.customElements.define('graphein-canvas', Canvas)\nmodule.exports = Canvas\n\n\n\n// WEBPACK FOOTER //\n// ./src/canvas.js","const Layer = require('./layer')\nconst Color = require('./color')\n\n// TODO: redo properly\n\n// reuse svg elements\nlet basePath = document.createElementNS('http://www.w3.org/2000/svg', 'path')\nlet widthL = document.createElementNS('http://www.w3.org/2000/svg', 'path')\nlet widthR = document.createElementNS('http://www.w3.org/2000/svg', 'path')\n\nclass StrokeRenderer {\n  constructor () {\n    this.path = []\n    this.widthL = [['M', 0, 0]]\n    this.widthR = [['M', 0, 0]]\n    this.cursor = [0, 0]\n    this.cursorL = [0, 0]\n    this.cursorR = [0, 0]\n  }\n\n  add (type, ...args) {\n    if (type.startsWith('_')) {\n      type = type.substr(1)\n      if (type === 'L') {\n        this.cursorL = [args[0], args[1]]\n        this.cursorR = [args[0], args[2]]\n        this.widthL.push([type, ...this.cursorL])\n        this.widthR.push([type, ...this.cursorR])\n      } else if (type === 'l') {\n        this.cursorL[0] += args[0]\n        this.cursorR[0] += args[0]\n        this.cursorL[1] += args[1]\n        this.cursorR[1] += args[2]\n        this.widthL.push([type, ...this.cursorL])\n        this.widthR.push([type, ...this.cursorR])\n      } else if (type === 'C') {\n        let leftArgs = args.slice(1, 5).concat([args[0], args[5]])\n        let rightArgs = args.slice(6, 10).concat([args[0], args[10]])\n        this.cursorL = [args[0], args[5]]\n        this.cursorR = [args[0], args[10]]\n        this.widthL.push(['C', ...leftArgs])\n        this.widthR.push(['C', ...rightArgs])\n      }\n      // TODO: c\n    } else {\n      this.path.push([type, ...args])\n    }\n  }\n\n  getPath () {\n    return this.path.map(item => item.join(' ')).join(' ')\n  }\n\n  getWidthL () {\n    return this.widthL.map(item => item.join(' ')).join(' ')\n  }\n\n  getWidthR () {\n    return this.widthR.map(item => item.join(' ')).join(' ')\n  }\n\n  render (ctx) {\n    basePath.setAttribute('d', this.getPath())\n    widthL.setAttribute('d', this.getWidthL())\n    widthR.setAttribute('d', this.getWidthR())\n\n    let baseLength = basePath.getTotalLength()\n    let resolution = 1 / window.devicePixelRatio\n\n    let cursor = null\n    let currentL = 0\n    let currentR = 0\n\n    let findNextPointAtX = (path, target, start = 0) => {\n      let x = start\n      let length = path.getTotalLength()\n\n      while (true) {\n        if (x > length) return Infinity\n        if (path.getPointAtLength(x).x >= target) {\n          return x\n        }\n        x += resolution\n      }\n    }\n\n    let lastLeftPos = 0\n    let lastRightPos = 0\n\n    for (let x = 0; x < baseLength; x += resolution) {\n      let point = basePath.getPointAtLength(x)\n\n      let leftPos = findNextPointAtX(widthL, x, lastLeftPos)\n      let rightPos = findNextPointAtX(widthR, x, lastRightPos)\n\n      let left = widthL.getPointAtLength(leftPos).y\n      let right = widthR.getPointAtLength(rightPos).y\n\n      // TODO: support jumps (M/m) midway\n\n      if (!cursor) {\n        ctx.beginPath()\n        ctx.moveTo(point.x, point.y)\n        cursor = [point.x, point.y]\n      }\n\n      if (left !== currentL || right !== currentR) {\n        currentL = left\n        currentR = right\n\n        // TODO: support asymmetry\n        ctx.stroke()\n        ctx.lineWidth = (currentL + currentR) / 2 // average for now\n        ctx.beginPath()\n        ctx.moveTo(...cursor)\n      }\n\n      ctx.lineTo(point.x, point.y)\n      cursor = [point.x, point.y]\n    }\n\n    ctx.stroke()\n  }\n}\n\nconst instructionFunctions = {\n  0x00: 'Z',\n  0x10: 'M',\n  0x11: 'm',\n  0x20: 'L',\n  0x21: 'l',\n  0x30: 'C',\n  0x31: 'c',\n  0x32: 'S',\n  0x33: 's',\n  0x40: 'Q',\n  0x41: 'q',\n  0x42: 'T',\n  0x43: 't',\n  0x50: 'A',\n  0x51: 'a',\n  0x60: '_L',\n  0x61: '_l',\n  0x62: '_C',\n  0x63: '_c'\n}\n\nclass Instruction {\n  constructor () {\n    this.type = 0\n    this.data = []\n  }\n\n  render (renderer) {\n    renderer.add(instructionFunctions[this.type], ...this.data)\n  }\n\n  serialize () {\n    return [this.type, this.data]\n  }\n\n  static types = {\n    CLOSE_PATH: 0,\n    MOVE: 0x10,\n    MOVE_R: 0x11,\n    LINE: 0x20,\n    LINE_R: 0x21,\n    CUBIC_BEZIER: 0x30,\n    CUBIC_BEZIER_R: 0x31,\n    CUBIC_BEZIER_SHORT: 0x32,\n    CUBIC_BEZIER_SHORT_R: 0x33,\n    QUAD_BEZIER: 0x40,\n    QUAD_BEZIER_R: 0x41,\n    QUAD_BEZIER_SHORT: 0x42,\n    QUAD_BEZIER_SHORT_R: 0x43,\n    ARC: 0x50,\n    ARC_R: 0x51,\n    STROKE_WIDTH: 0x60,\n    STROKE_WIDTH_R: 0x61,\n    STROKE_WIDTH_BEZIER: 0x62,\n    STROKE_WIDTH_BEZIER_R: 0x63\n  }\n}\n\nmodule.exports = class Path extends Layer {\n  constructor () {\n    super()\n\n    this.stroke = new Color()\n    this.fill = new Color()\n    this.cap = Path.cap.BUTT\n    this.join = Path.join.BEVEL\n    this.miter = 0\n    this.data = []\n  }\n\n  render (ctx) {\n    let renderer = new StrokeRenderer()\n    this.data.forEach(instruction => instruction.render(renderer))\n\n    if (this.fill.alpha) {\n      ctx.fillStyle = this.fill.toCSS()\n      ctx.fill(new window.Path2D(renderer.getPath()))\n    }\n    if (this.stroke.alpha) {\n      ctx.strokeStyle = this.stroke.toCSS()\n      renderer.render(ctx)\n    }\n  }\n\n  static cap = {\n    BUTT: 0,\n    ROUND: 1,\n    PROJECTING: 2\n  }\n\n  static join = {\n    BEVEL: 0,\n    ROUND: 1,\n    MITER: 2\n  }\n\n  static Instruction = Instruction\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/path.js","module.exports = class Color {\n  constructor () {\n    this.alpha = 0\n    this.red = 0\n    this.green = 0\n    this.blue = 0\n  }\n\n  toCSS () {\n    return `rgba(${this.red * 255}, ${this.green * 255}, ${this.blue * 255}, ${this.alpha})`\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/color.js"],"sourceRoot":""}